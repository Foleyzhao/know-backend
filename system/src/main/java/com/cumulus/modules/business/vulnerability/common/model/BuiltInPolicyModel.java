package com.cumulus.modules.business.vulnerability.common.model;

import lombok.AllArgsConstructor;
import lombok.Getter;
import lombok.NoArgsConstructor;
import lombok.Setter;

import java.io.Serializable;

/**
 * 内置策略模型
 *
 * @author : shenjc
 */
@Getter
@Setter
@AllArgsConstructor
@NoArgsConstructor
public class BuiltInPolicyModel implements Serializable {

    private static final long serialVersionUID = -5041962034989012240L;

    /**
     * 是否进行poc扫描
     */
    private boolean pocScan = true;

    /**
     * 是否进行版本扫描
     */
    private boolean versionMatch = false;

    /**
     * 是否进行弱口令扫描
     */
    private boolean weakPassBrute = false;

    /**
     * 是否进行弱口令扫描
     */
    private Integer policyId;

    public BuiltInPolicyModel(Integer policyId) {
        this.policyId = policyId;
    }

    /**
     * 获取policyId
     */
    public Integer getPolicyId() {
        if (policyId != null) {
            return policyId;
        }
        int id = 0;
        if (pocScan) {
            id++;
        }
        id = id << 1;
        if (versionMatch) {
            id++;
        }
        id = id << 1;
        if (weakPassBrute) {
            id++;
        }
        return id;
    }

    /**
     * 获取pocScan
     */
    public boolean isPocScan() {
        if (policyId != null) {
            return ((policyId >> 2) & 0x1) != 0;
        }
        return pocScan;
    }

    /**
     * 获取版本匹配
     */
    public boolean isVersionMatch() {
        if (policyId != null) {
            return ((policyId >> 1) & 0x1) != 0;
        }
        return versionMatch;
    }

    /**
     * 获取弱密码检测
     */
    public boolean isWeakPassBrute() {
        if (policyId != null) {
            return (this.policyId & 0x1) != 0;
        }
        return weakPassBrute;
    }
}
