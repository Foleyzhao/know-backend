package com.cumulus.modules.business.vulnerability.dto;

import com.cumulus.utils.AdapterCDATA;

import javax.xml.bind.annotation.XmlAccessType;
import javax.xml.bind.annotation.XmlAccessorType;
import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlElementWrapper;
import javax.xml.bind.annotation.XmlRootElement;
import javax.xml.bind.annotation.XmlTransient;
import javax.xml.bind.annotation.adapters.XmlJavaTypeAdapter;
import java.util.ArrayList;
import java.util.List;


/**
 * config
 *
 * @author zhaoff
 */
@XmlRootElement(name = "config")
@XmlAccessorType(XmlAccessType.FIELD)
public class ScanXmlConfigBean {

    /**
     * server key name: task_type
     */
    public static final String TASK_TYPE = "task_type";

    /**
     * server key value: 默认-ip
     */
    public static final String TASK_TYPE_VALUE = "ip";

    /**
     * server key name: targets
     */
    public static final String TARGETS = "targets";

    /**
     * server key name: isguesspwd
     */
    public static final String ISGUESSPWD = "isguesspwd";

    /**
     * server key value: 默认-no
     */
    public static final String ISGUESSPWD_VALUE = "no";

    /**
     * server key name: port_strategy
     */
    public static final String PORT_STRATEGY = "port_strategy";

    /**
     * server key value: 默认-fast
     */
    public static final String PORT_STRATEGY_VALUE = "fast";

    /**
     * server key name: port_speed
     */
    public static final String PORT_SPEED = "port_speed";

    /**
     * server key value: 默认-3
     */
    public static final String PORT_SPEED_VALUE = "3";

    /**
     * server key name: port_tcp
     */
    public static final String PORT_TCP = "port_tcp";

    /**
     * server key value: 默认-T
     */
    public static final String PORT_TCP_VALUE = "T";

    /**
     * server key name: port_udp
     */
    public static final String PORT_UDP = "port_udp";

    /**
     * server key value: 默认-no
     */
    public static final String PORT_UDP_VALUE = "no";

    /**
     * server key name: scan_level
     */
    public static final String SCAN_LEVEL = "scan_level";

    /**
     * server key value: 默认-3
     */
    public static final String SCAN_LEVEL_VALUE = "3";

    /**
     * server key name: timeout_plugins
     */
    public static final String TIMEOUT_PLUGINS = "timeout_plugins";

    /**
     * server key value: 默认-40
     */
    public static final String TIMEOUT_PLUGINS_VALUE = "40";

    /**
     * server key name: timeout_read
     */
    public static final String TIMEOUT_READ = "timeout_read";

    /**
     * server key value: 默认-5
     */
    public static final String TIMEOUT_READ_VALUE = "5";

    /**
     * server key name: enable_unsafe_plugins
     */
    public static final String ENABLE_UNSAFE_PLUGINS = "enable_unsafe_plugins";

    /**
     * server key value: 默认-no
     */
    public static final String ENABLE_UNSAFE_PLUGINS_VALUE = "no";

    /**
     * server key name: scan_alert
     */
    public static final String SCAN_ALERT = "scan_alert";

    /**
     * server key value: 默认-no
     */
    public static final String SCAN_ALERT_VALUE = "no";

    /**
     * server key name: scan_huawei
     */
    public static final String SCAN_HUAWEI = "scan_huawei";

    /**
     * server key value: 默认-no
     */
    public static final String SCAN_HUAWEI_VALUE = "no";

    /**
     * server key name: ifdebug
     */
    public static final String IFDEBUG = "ifdebug";

    /**
     * server key value: 默认-no
     */
    public static final String IFDEBUG_VALUE = "no";

    /**
     * server key name: encoding
     */
    public static final String ENCODING = "encoding";

    /**
     * server key value: 默认 UTF-8
     */
    public static final String ENCODING_VALUE = "UTF-8";

    /**
     * server
     */
    @XmlElement(name = "key")
    @XmlElementWrapper(name = "server")
    private List<ScanXmlServerBean> server = new ArrayList<>();

    /**
     * serverTargets
     */
    @XmlTransient
    private ScanXmlServerBean serverTargets = new ScanXmlServerBean();

    /**
     * targets
     */
    @XmlElement(name = "target")
    @XmlElementWrapper(name = "targets")
    private List<ScanXmlTargetBean> targets = new ArrayList<>();

    /**
     * pwdguess
     */
    @XmlElement(name = "pwdguess")
    private String pwdGuess = "";

    /**
     * taskname
     */
    @XmlElement(name = "taskname")
    @XmlJavaTypeAdapter(AdapterCDATA.class)
    private String taskName;

    /**
     * plugin_template_id
     */
    @XmlElement(name = "plugin_template_id")
    private String plugin;

    /**
     * scanpri
     */
    @XmlElement(name = "scanpri")
    private String scanPri = "2";

    public ScanXmlConfigBean() {
        ScanXmlServerBean serverBean = new ScanXmlServerBean();
        serverBean.setName(TASK_TYPE);
        serverBean.setValue(TASK_TYPE_VALUE);
        addServer(serverBean);
        serverTargets.setName(TARGETS);
        addServer(serverTargets);
        serverBean = new ScanXmlServerBean();
        serverBean.setName(ISGUESSPWD);
        serverBean.setValue(ISGUESSPWD_VALUE);
        addServer(serverBean);
        serverBean = new ScanXmlServerBean();
        serverBean.setName(PORT_STRATEGY);
        serverBean.setValue(PORT_STRATEGY_VALUE);
        addServer(serverBean);
        serverBean = new ScanXmlServerBean();
        serverBean.setName(PORT_SPEED);
        serverBean.setValue(PORT_SPEED_VALUE);
        addServer(serverBean);
        serverBean = new ScanXmlServerBean();
        serverBean.setName(PORT_TCP);
        serverBean.setValue(PORT_TCP_VALUE);
        addServer(serverBean);
        serverBean = new ScanXmlServerBean();
        serverBean.setName(PORT_UDP);
        serverBean.setValue(PORT_UDP_VALUE);
        addServer(serverBean);
        serverBean = new ScanXmlServerBean();
        serverBean.setName(SCAN_LEVEL);
        serverBean.setValue(SCAN_LEVEL_VALUE);
        addServer(serverBean);
        serverBean = new ScanXmlServerBean();
        serverBean.setName(TIMEOUT_PLUGINS);
        serverBean.setValue(TIMEOUT_PLUGINS_VALUE);
        addServer(serverBean);
        serverBean = new ScanXmlServerBean();
        serverBean.setName(TIMEOUT_READ);
        serverBean.setValue(TIMEOUT_READ_VALUE);
        addServer(serverBean);
        serverBean = new ScanXmlServerBean();
        serverBean.setName(ENABLE_UNSAFE_PLUGINS);
        serverBean.setValue(ENABLE_UNSAFE_PLUGINS_VALUE);
        addServer(serverBean);
        serverBean = new ScanXmlServerBean();
        serverBean.setName(SCAN_ALERT);
        serverBean.setValue(SCAN_ALERT_VALUE);
        addServer(serverBean);
        serverBean = new ScanXmlServerBean();
        serverBean.setName(SCAN_HUAWEI);
        serverBean.setValue(SCAN_HUAWEI_VALUE);
        addServer(serverBean);
        serverBean = new ScanXmlServerBean();
        serverBean.setName(IFDEBUG);
        serverBean.setValue(IFDEBUG_VALUE);
        addServer(serverBean);
        serverBean = new ScanXmlServerBean();
        serverBean.setName(ENCODING);
        serverBean.setValue(ENCODING_VALUE);
        addServer(serverBean);
    }

    public List<ScanXmlServerBean> getServer() {
        return server;
    }

    public void setServer(List<ScanXmlServerBean> server) {
        this.server = server;
    }

    public void addServer(ScanXmlServerBean server) {
        if (this.server == null) {
            this.server = new ArrayList<>();
        }
        this.server.add(server);
    }

    public void addAllServer(List<ScanXmlServerBean> server) {
        if (this.server == null) {
            this.server = new ArrayList<>();
        }
        this.server.addAll(server);
    }

    public ScanXmlServerBean getServerTargets() {
        return serverTargets;
    }

    public void setServerTargets(ScanXmlServerBean serverTargets) {
        this.serverTargets = serverTargets;
    }

    public List<ScanXmlTargetBean> getTargets() {
        return targets;
    }

    public void setTargets(List<ScanXmlTargetBean> targets) {
        this.targets = targets;
    }

    public void addTarget(ScanXmlTargetBean target) {
        if (this.targets == null) {
            this.targets = new ArrayList<>();
        }
        this.targets.add(target);
    }

    public void addAllTargets(List<ScanXmlTargetBean> targets) {
        if (this.targets == null) {
            this.targets = new ArrayList<>();
        }
        this.targets.addAll(targets);
    }

    public String getPwdGuess() {
        return pwdGuess;
    }

    public void setPwdGuess(String pwdGuess) {
        this.pwdGuess = pwdGuess;
    }

    public String getTaskName() {
        return taskName;
    }

    public void setTaskName(String taskName) {
        this.taskName = taskName;
    }

    public String getPlugin() {
        return plugin;
    }

    public void setPlugin(String plugin) {
        this.plugin = plugin;
    }

    public String getScanPri() {
        return scanPri;
    }

    public void setScanPri(String scanPri) {
        this.scanPri = scanPri;
    }
}
