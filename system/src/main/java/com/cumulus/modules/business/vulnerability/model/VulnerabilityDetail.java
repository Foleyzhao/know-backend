package com.cumulus.modules.business.vulnerability.model;

import com.fasterxml.jackson.annotation.JsonInclude;
import com.fasterxml.jackson.annotation.JsonInclude.Include;
import lombok.Getter;
import lombok.Setter;

import javax.persistence.Id;
import java.io.Serializable;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;

/**
 * 漏洞详情
 *
 * @author zhaoff
 */
@Getter
@Setter
@JsonInclude(Include.NON_EMPTY)
public class VulnerabilityDetail implements Serializable {

    private static final long serialVersionUID = 3735052186060582614L;

    /**
     * 漏洞ID
     */
    @Id
    private String id;

    /**
     * 漏洞所属设备ID
     */
    private Integer devId;

    /**
     * 漏洞所属设备名称
     */
    private String devName;

    /**
     * 漏洞分类ID，在tenable上唯一标识
     */
    private String pluginId;

    /**
     * 漏洞级别, Critical/High/Medium
     */
    private String severity;

    /**
     * 漏洞级别
     */
    private Long level;

    /**
     * 风险类型
     */
    private List<Long> riskType = new ArrayList<>();

    /**
     * 漏洞类别
     */
    private String bugType;

    /**
     * 漏洞修复状态，已修复/未修复
     */
    private String status;

    /**
     * 未修复漏洞发现时间
     */
    private Long time;

    /**
     * 漏洞名
     */
    private String pluginName;

    /**
     * 解决方案
     */
    private String solution;

    /**
     * 扫描器类型
     */
    private String scanType;

    /**
     * 漏洞详情
     * eg:
     * {
     * "pluginID":"10114",
     * "severity":{
     * "id":0,
     * "name":"Info"
     * },
     * "ip":"10.10.66.212",
     * "port":"0",
     * "protocol":"ICMP",
     * "pluginName":"ICMP...",
     * "desciption":"...",
     * "solution":"...",
     * "version":"Revision:1.45"
     * }
     */
    private Map<String, Object> detail;

}
