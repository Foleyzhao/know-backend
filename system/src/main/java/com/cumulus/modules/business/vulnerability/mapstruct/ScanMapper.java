package com.cumulus.modules.business.vulnerability.mapstruct;

import com.cumulus.base.BaseMapper;
import com.cumulus.enums.ScanProduct;
import com.cumulus.modules.business.vulnerability.dto.ScanDto;
import com.cumulus.modules.business.vulnerability.entity.Scan;
import org.mapstruct.Mapper;
import org.mapstruct.Mapping;
import org.mapstruct.ReportingPolicy;

/**
 * 扫描器实体 DTO 转换Mapper
 *
 * @author : shenjc
 */
@Mapper(componentModel = "spring", unmappedTargetPolicy = ReportingPolicy.IGNORE, imports = {ScanProduct.class})
public interface ScanMapper extends BaseMapper<ScanDto, Scan> {

    /**
     * 实体类转换为Dto
     *
     * @param entity 实体类对象
     * @return 返回Dto对象
     */
    @Override
    @Mapping(target = "productName", expression = "java(ScanProduct.getNameById(entity.getProduct()))")
    ScanDto toDto(Scan entity);
}
