package com.cumulus.modules.business.vulnerability.common.model;

import lombok.AllArgsConstructor;
import lombok.Getter;
import lombok.NoArgsConstructor;
import lombok.Setter;

import java.io.Serializable;
import java.util.List;
import java.util.Map;

/**
 * 接收的引擎实体结构
 *
 * @author : shenjc
 */
@Getter
@Setter
@AllArgsConstructor
@NoArgsConstructor
public class BuiltInVulReceiveModel implements Serializable {
    private static final long serialVersionUID = -3881869819409542874L;

    public static final String RISK_LEVEL_SUPPER = "超危";
    public static final String RISK_LEVEL_HIGH = "高危";
    public static final String RISK_LEVEL_MIDDLE = "中危";
    public static final String RISK_LEVEL_LOW = "低危";
    /**
     * 漏洞详情信息
     */
    private Map<String, List<VulInfo>> resList;

    /**
     * 任务id
     */
    private String planId;

    /**
     * 漏洞类型 （host web）
     */
    private String targetType;


    /**
     * 单个风险信息
     *
     * @author shenjc
     */
    @Getter
    @Setter
    @AllArgsConstructor
    @NoArgsConstructor
    public static class VulInfo {

        /**
         * 风险名
         */
        private String name;

        /**
         * 风险级别
         */
        private String level;

        /**
         * 风险描述
         */
        private String description;

        /**
         * 解决方案
         */
        private String solution;

        /**
         * cve编号 优先
         */
        private String cve;

        /**
         * cvss3 可信度 优先
         */
        private String cvss3;

        /**
         * cvss2 可信度
         */
        private String cvss2;

        /**
         * cnnvd 编号
         */
        private String cnnvd;

        /**
         * 漏洞类型（xxx漏洞）暂时没用
         */
        private String vulType;

        /**
         * 暂时没用
         */
        private String channel;

        /**
         * 暂时没用
         */
        private String port;

        /**
         * 唯一标识 用于不存在 cve cnnd 等编号的风险如弱口令
         */
        private String hash;
    }
}
